"use strict";(self.webpackChunkdocs_docusaurus=self.webpackChunkdocs_docusaurus||[]).push([[336],{13150:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>r,contentTitle:()=>t,default:()=>u,frontMatter:()=>s,metadata:()=>o,toc:()=>d});const o=JSON.parse('{"id":"core-concepts/packages/c-module","title":"C Module","description":"Custom Lua C Binaries Libraries","source":"@site/docs/core-concepts/packages/c-module.md","sourceDirName":"core-concepts/packages","slug":"/core-concepts/packages/c-module","permalink":"/docs/next/core-concepts/packages/c-module","draft":false,"unlisted":false,"editUrl":"https://github.com/nanos-world/docs/edit/master/docs/core-concepts/packages/c-module.md","tags":[{"inline":true,"label":"scripting","permalink":"/docs/next/tags/scripting"},{"inline":true,"label":"packages","permalink":"/docs/next/tags/packages"}],"version":"current","lastUpdatedBy":"Gabriel Tanasovici Nardy","lastUpdatedAt":1749849787000,"sidebarPosition":1,"frontMatter":{"title":"C Module","description":"Custom Lua C Binaries Libraries","sidebar_position":1,"tags":["scripting","packages"],"keywords":["c","module","library","binary","package"]},"sidebar":"main","previous":{"title":"Packages Guide","permalink":"/docs/next/core-concepts/packages/packages-guide"},"next":{"title":"Loading Screen","permalink":"/docs/next/core-concepts/packages/loading-screen"}}');var a=i(74848),l=i(28453);const s={title:"C Module",description:"Custom Lua C Binaries Libraries",sidebar_position:1,tags:["scripting","packages"],keywords:["c","module","library","binary","package"]},t=void 0,r={},d=[{value:"Creating your C Module binaries",id:"creating-your-c-module-binaries",level:2},{value:"First Steps",id:"first-steps",level:4},{value:"Understanding the example",id:"understanding-the-example",level:3},{value:"Compiling your C Module",id:"compiling-your-c-module",level:3},{value:"Creating a C Module Package",id:"creating-a-c-module-package",level:2},{value:"Loading and Using your C Module",id:"loading-and-using-your-c-module",level:2}];function c(e){const n={a:"a",admonition:"admonition",code:"code",h2:"h2",h3:"h3",h4:"h4",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,l.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.p,{children:"C Module is a Package type that allows extending the functionalities of nanos world Scripting API"}),"\n",(0,a.jsx)(n.p,{children:"C Modules allows you to extend the functionality of the nanos world scripting API on the server side. Currently only C modules are supported."}),"\n",(0,a.jsx)(n.admonition,{type:"caution",children:(0,a.jsx)(n.p,{children:"Be aware that this part of the scripting API is currently work in progress and may change at any time."})}),"\n",(0,a.jsx)(n.admonition,{type:"caution",children:(0,a.jsx)(n.p,{children:"This is an advanced procedure so instabilities and even crashes may occur."})}),"\n",(0,a.jsx)(n.h2,{id:"creating-your-c-module-binaries",children:"Creating your C Module binaries"}),"\n",(0,a.jsxs)(n.p,{children:["To create your own module, fist make sure you have ",(0,a.jsx)(n.strong,{children:"Visual Studio"})," installed with ",(0,a.jsx)(n.strong,{children:"Desktop development with C++"})," (and ",(0,a.jsx)(n.strong,{children:"CMake"}),") or any other C compiler on Linux."]}),"\n",(0,a.jsx)(n.h4,{id:"first-steps",children:"First Steps"}),"\n",(0,a.jsxs)(n.ol,{children:["\n",(0,a.jsxs)(n.li,{children:["Then, clone our ",(0,a.jsx)(n.a,{href:"https://github.com/nanos-world-modules/module-example",children:"example module"})," in your computer to get start with it."]}),"\n",(0,a.jsxs)(n.li,{children:["After cloning, you will need to download it's submodules with ",(0,a.jsx)(n.code,{children:"git submodule update --init --recursive"})," - this will download the ",(0,a.jsx)(n.a,{href:"https://github.com/nanos-world/module-sdk/",children:"module-sdk"})," as a git submodule into deps/ folder automatically."]}),"\n"]}),"\n",(0,a.jsx)(n.h3,{id:"understanding-the-example",children:"Understanding the example"}),"\n",(0,a.jsxs)(n.p,{children:["The important file is under ",(0,a.jsx)(n.code,{children:"src/example.cpp"}),":"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-cpp",metastring:"reference",children:"https://github.com/nanos-world-modules/module-example/blob/main/src/example.cpp\n"})}),"\n",(0,a.jsx)(n.h3,{id:"compiling-your-c-module",children:"Compiling your C Module"}),"\n",(0,a.jsx)(n.p,{children:"To compile the example, follow the steps:"}),"\n",(0,a.jsxs)(n.ol,{children:["\n",(0,a.jsxs)(n.li,{children:["Create a folder called ",(0,a.jsx)(n.code,{children:"build/"}),": ",(0,a.jsx)(n.code,{children:"mkdir build"})]}),"\n",(0,a.jsxs)(n.li,{children:["Enter the build folder: ",(0,a.jsx)(n.code,{children:"cd build"})]}),"\n",(0,a.jsxs)(n.li,{children:["Generate the cmake build files with ",(0,a.jsx)(n.code,{children:"cmake .."})]}),"\n",(0,a.jsxs)(n.li,{children:["Finally build it with ",(0,a.jsx)(n.code,{children:"cmake --build . --config Release"})]}),"\n"]}),"\n",(0,a.jsx)(n.p,{children:"This will generate the compiled library at:"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:["For Windows: ",(0,a.jsx)(n.code,{children:"build/Release/example.dll"})]}),"\n",(0,a.jsxs)(n.li,{children:["For Linux: ",(0,a.jsx)(n.code,{children:"build/libexample.so"})]}),"\n"]}),"\n",(0,a.jsx)(n.admonition,{type:"tip",children:(0,a.jsxs)(n.p,{children:["If you intend to make your module available for both Linux and Windows servers, you must also compile the ",(0,a.jsx)(n.code,{children:".so"})," files in a Linux machine and deliver both library files with your Package."]})}),"\n",(0,a.jsx)(n.h2,{id:"creating-a-c-module-package",children:"Creating a C Module Package"}),"\n",(0,a.jsxs)(n.p,{children:["First of all, create a new Package of type ",(0,a.jsx)(n.a,{href:"packages-guide#c-module",children:"c-module"}),", and add your ",(0,a.jsx)(n.code,{children:".dll"})," (windows) and/or ",(0,a.jsx)(n.code,{children:".so"})," (linux) files into the Package's root folder. It will look like that:"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-folder-structure",children:"Packages/\n\u2514\u2500\u2500 my-module/\n    \u251c\u2500\u2500 Package.toml\n    \u251c\u2500\u2500 example.dll\n    \u2514\u2500\u2500 libexample.so\n"})}),"\n",(0,a.jsxs)(n.p,{children:["Then add the name of your module library (in our case, ",(0,a.jsx)(n.code,{children:"example"}),") to the Package.toml ",(0,a.jsx)(n.strong,{children:"modules"})," list:"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-toml",metastring:'title="my-module/Package.toml"',children:'# vault configurations\n[meta]\n    # friendly name\n    title =                 "My Awesome C Module"\n    # contributors\n    author =                "Contributor Names"\n    # version\n    version =               "0.1.0"\n\n# c module configurations\n[c_module]\n    # list of modules to load (without file extension)\n    modules = [\n                            # highlight-next-line\n                            "example",\n    ]\n'})}),"\n",(0,a.jsx)(n.h2,{id:"loading-and-using-your-c-module",children:"Loading and Using your C Module"}),"\n",(0,a.jsx)(n.p,{children:"Now you can load the package you created as usual, by adding it to the Config.toml's list of Packages requirement or by adding it to another Package's Package.toml as dependency, e.g.:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-toml",metastring:'title="Server/Config.toml"',children:'...\n# game configurations\n[game]\n    # default startup map\n    map =               "default-blank-map"\n    # game-mode package to load (set the main game-mode package to load - you can load only one \'game-mode\' package type at once)\n    game_mode =         ""\n    # packages list (set the packages you want to load)\n    packages = [\n                        # highlight-next-line\n                        "my-module",\n    ]\n...\n'})}),"\n",(0,a.jsx)(n.p,{children:"And in your Package, you can load and use it like:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-lua",metastring:'title="my-awesome-package/Server/Index.lua" showLineNumbers',children:"-- Calls the module function 'test'\n-- Will print 'Hello World' on console\nConsole.Log(example.test())\n"})})]})}function u(e={}){const{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(c,{...e})}):c(e)}},28453:(e,n,i)=>{i.d(n,{R:()=>s,x:()=>t});var o=i(96540);const a={},l=o.createContext(a);function s(e){const n=o.useContext(l);return o.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function t(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:s(e.components),o.createElement(l.Provider,{value:n},e.children)}}}]);